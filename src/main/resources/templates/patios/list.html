<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pátios - Mottu Yard</title>
    <th:block th:replace="fragments/assets :: tailwind"></th:block>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body class="bg-slate-200 text-slate-800 min-h-screen flex flex-col">
    <header th:replace="~{fragments/app-header :: header('patios')}"></header>

    <main class="flex-1">
        <div class="max-w-7xl mx-auto px-6 py-10 space-y-8">
            <th:block th:replace="~{fragments/page-components :: page-header('Gestão de Pátios', 'Acompanhe a capacidade e a ocupação de motos de cada pátio cadastrado.', @{/patios/create}, 'Novo Pátio')}"></th:block>
            <th:block th:replace="~{fragments/page-components :: alerts}"></th:block>

            <section th:if="${patios != null and !#lists.isEmpty(patios)}" class="rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden">
                <div class="hidden md:grid grid-cols-12 gap-4 border-b border-slate-200 bg-slate-50 px-6 py-3 text-xs font-semibold uppercase tracking-wide text-navy">
                    <span class="col-span-3">Pátio</span>
                    <span class="col-span-3">Endereço</span>
                    <span class="col-span-2 text-right">Capacidade</span>
                    <span class="col-span-2 text-right">Ocupação</span>
                    <span class="col-span-2 text-right">Ações</span>
                </div>
                <div class="divide-y divide-slate-200">
                    <div th:each="patio : ${patios}" class="flex flex-col gap-4 px-6 py-4 transition hover:bg-slate-50 md:grid md:grid-cols-12 md:items-center">
                        <div class="md:col-span-3">
                            <p class="text-sm font-semibold text-slate-800" th:text="${patio.nome}">Pátio</p>
                            <p class="text-xs text-slate-500" th:text="${patio.id}">ID</p>
                        </div>
                        <div class="md:col-span-3 text-sm text-slate-600" th:text="${patio.endereco}">Endereço</div>
                        <div class="md:col-span-2 text-right text-sm font-medium text-slate-700" th:text="${patio.capacidadeMaxima}">0</div>
                        <div class="md:col-span-2 text-right">
                            <div class="text-sm font-semibold text-navy" th:text="${patioService.getOcupacaoAtual(patio)}">0</div>
                        </div>
                        <div class="lg:col-span-2 flex flex-wrap justify-end gap-2">
                            <a th:href="@{|/patios/details/${patio.id}|}" class="inline-flex items-center gap-1 rounded-lg border border-slate-200 px-3 py-2 text-xs font-semibold text-slate-600 hover:border-slate-400 hover:text-slate-800">
                                <i class="bi bi-eye"></i>
                                Detalhes
                            </a>
                            <a th:href="@{|/patios/edit/${patio.id}|}" sec:authorize="hasRole('OPERADOR')"
                               class="inline-flex items-center gap-1 rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-xs font-semibold text-amber-700 hover:border-amber-300">
                                <i class="bi bi-pencil"></i>
                                Editar
                            </a>
                            <form th:action="@{|/patios/delete/${patio.id}|}" method="post"
                                  onsubmit="return confirm('Confirma a exclusão deste pátio?');" sec:authorize="hasRole('OPERADOR')">
                                <button type="submit" class="inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-xs font-semibold text-rose-700 hover:border-rose-300">
                                    <i class="bi bi-trash"></i>
                                    Excluir
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </section>

            <section th:unless="${patios != null and !#lists.isEmpty(patios)}" class="rounded-2xl border border-dashed border-slate-300 bg-white/70 shadow-sm">
                <th:block th:replace="~{fragments/page-components :: empty-list('Nenhum pátio encontrado.')}"></th:block>
            </section>
        </div>
    </main>

    <footer th:replace="~{fragments/app-footer :: footer}"></footer>
</body>
</html>
